!function(a,b,c,d){"use strict";var e={version:"0.0.1",settings:{donut:!1,donut_inner_ratio:.4,percent_offset:35,stroke_color:"#333",stroke_width:0,show_percent:!0,animation_speed:500,always_show_percent:!1,animation_type:"elastic"},init:function(b,d){var e=this;this.scope=b||c.body;var f=a("[data-pie-id]",this.scope);a.extend(!0,this.settings,d),f.length>0?f.each(function(){return e.build(a(this),d)}):this.build(a(this.scope),d),this.events()},events:function(){var c=this;a(b).off(".pizza").on("resize.pizza",c.throttle(function(){c.init()},100)),a(this.scope).off(".pizza").on("mouseenter.pizza mouseleave.pizza touchstart.pizza","[data-pie-id] li",function(b){var c=a(this).parent(),d=Snap(a("#"+c.data("pie-id")+' path[data-id="s'+a(this).index()+'"]')[0]),e=Snap(a(d.node).parent().find('text[data-id="'+d.node.getAttribute("data-id")+'"]')[0]),f=a(this).parent().data("settings");/start/i.test(b.type)&&a(d.node).siblings("path").each(function(){this.nodeName&&(d.animate({transform:"s1 1 "+d.node.getAttribute("data-cx")+" "+d.node.getAttribute("data-cy")},f.animation_speed,mina[f.animation_type]),Snap(a(this).next()[0]).animate({opacity:0},f.animation_speed))}),/enter|start/i.test(b.type)?(d.animate({transform:"s1.05 1.05 "+d.node.getAttribute("data-cx")+" "+d.node.getAttribute("data-cy")},f.animation_speed,mina[f.animation_type]),f.show_percent&&e.animate({opacity:1},f.animation_speed)):(d.animate({transform:"s1 1 "+d.node.getAttribute("data-cx")+" "+d.node.getAttribute("data-cy")},f.animation_speed,mina[f.animation_type]),e.animate({opacity:0},f.animation_speed))})},build:function(b,c){var d=this,e=b;return e.data("settings",a.extend({},d.settings,c,e.data("options"))),d.data(e,c||{}),d.update_DOM(d.pie(e))},data:function(b,c){var d=[];return a("li",b).each(function(){var b=a(this);c.data?d.push({value:c.data[b.index()],color:b.css("color"),segment:b}):d.push({value:b.data("value"),color:b.css("color"),segment:b})}),b.data("graph-data",d)},update_DOM:function(b){var c=b[0],d=b[1];return a(this.identifier(c)).html(d)},pie:function(b){for(var c=b.data("settings"),d=this.svg(b,c),e=b.data("graph-data"),f=0,g=[],h=0,i=a(this.identifier(b)).width()-4,j=0;j<e.length;j++)f+=e[j].value;for(var j=0;j<e.length;j++)g[j]=2*e[j].value/f*Math.PI;for(var j=0;j<e.length;j++){var k=h+g[j],l=i/2,m=i/2,n=.85*(i/2);if(!c.donut){var o=l+n*Math.sin(h),p=m-n*Math.cos(h),q=l+n*Math.sin(k),r=m-n*Math.cos(k),s=0;k-h>Math.PI&&(s=1);var t="M"+l+","+m+" L"+o+","+p+" A"+n+","+n+" 0 "+s+" 1 "+q+","+r+" Z"}var u=a('path[data-id="s'+j+'"]',d.node);if(u.length>0)var v=Snap(u[0]);else var v=d.path();var w=100*(e[j].value/f),x=a('text[data-id="s'+j+'"]',d.node);if(x.length>0){var y=Snap(x[0]);y.attr({x:l+(n+c.percent_offset)*Math.sin(h+g[j]/2),y:m-(n+c.percent_offset)*Math.cos(h+g[j]/2)})}else var y=v.paper.text(l+(n+c.percent_offset)*Math.sin(h+g[j]/2),m-(n+c.percent_offset)*Math.cos(h+g[j]/2),Math.ceil(w)+"%");var z=y.getBBox().width/2;c.always_show_percent?y.attr({x:y.attr("x")-z,opacity:1}):y.attr({x:y.attr("x")-z,opacity:0}),y.node.setAttribute("data-id","s"+j),v.node.setAttribute("data-cx",l),v.node.setAttribute("data-cy",m),c.donut?this.annular_sector(v.node,{centerX:l,centerY:m,startDegrees:h,endDegrees:k,innerRadius:n*c.donut_inner_ratio,outerRadius:n}):v.attr({d:t}),v.attr({fill:e[j].color,stroke:c.stroke_color,strokeWidth:c.stroke_width}),v.node.setAttribute("data-id","s"+j),this.animate(v,l,m,c),h=k}return[b,d.node]},animate:function(b,c,d,e){b.hover(function(b){var f=Snap(b.target),g=Snap(a(f.node).parent().find('text[data-id="'+f.node.getAttribute("data-id")+'"]')[0]);f.animate({transform:"s1.05 1.05 "+c+" "+d},e.animation_speed,mina[e.animation_type]),g.touchend(function(){f.animate({transform:"s1.05 1.05 "+c+" "+d},e.animation_speed,mina[e.animation_type])}),e.show_percent&&(g.animate({opacity:1},e.animation_speed),g.touchend(function(){g.animate({opacity:1},e.animation_speed)}))},function(b){var f=Snap(b.target),g=Snap(a(f.node).parent().find('text[data-id="'+f.node.getAttribute("data-id")+'"]')[0]);f.animate({transform:"s1 1 "+c+" "+d},e.animation_speed,mina[e.animation_type]),g.animate({opacity:0},e.animation_speed)})},svg:function(b,c){var d=a(this.identifier(b)),e=a("svg",d),f=d.width(),g=f;return e=e.length>0?Snap(e[0]):Snap(f,g),e.node.setAttribute("width",f+c.percent_offset),e.node.setAttribute("height",g+c.percent_offset),e.node.setAttribute("viewBox","-"+c.percent_offset+" -"+c.percent_offset+" "+(f+1.5*c.percent_offset)+" "+(g+1.5*c.percent_offset)),e},annular_sector:function(a,b){function i(a){var b={cx:a.centerX||0,cy:a.centerY||0,startRadians:a.startDegrees||0,closeRadians:a.endDegrees||0},c=a.thickness!==d?a.thickness:100;return b.r1=a.innerRadius!==d?a.innerRadius:a.outerRadius!==d?a.outerRadius-c:200-c,b.r2=a.outerRadius!==d?a.outerRadius:b.r1+c,b.r1<0&&(b.r1=0),b.r2<0&&(b.r2=0),b}var c=i(b),e=[[c.cx+c.r2*Math.sin(c.startRadians),c.cy-c.r2*Math.cos(c.startRadians)],[c.cx+c.r2*Math.sin(c.closeRadians),c.cy-c.r2*Math.cos(c.closeRadians)],[c.cx+c.r1*Math.sin(c.closeRadians),c.cy-c.r1*Math.cos(c.closeRadians)],[c.cx+c.r1*Math.sin(c.startRadians),c.cy-c.r1*Math.cos(c.startRadians)]],f=c.closeRadians-c.startRadians,g=f%(2*Math.PI)>Math.PI?1:0,h=[];h.push("M"+e[0].join()),h.push("A"+[c.r2,c.r2,0,g,1,e[1]].join()),h.push("L"+e[2].join()),h.push("A"+[c.r1,c.r1,0,g,0,e[3]].join()),h.push("z"),a.setAttribute("d",h.join(" "))},identifier:function(a){return"#"+a.data("pie-id")},throttle:function(a,b){var c=null;return function(){var d=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(d,e)},b)}}};b.Pizza=e}($,this,this.document);