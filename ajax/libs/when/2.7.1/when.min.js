/** @license MIT License (c) copyright 2011-2013 original author or authors */
!function(n){"use strict";n(function(n){function t(n,t,e,r){return u(n).then(t,e,r)}function e(n){return new r(n,D.PromiseStatus&&D.PromiseStatus())}function r(n,t){function e(){return h?h.inspect():T()}function r(n,t,e,r,u){function i(i){i._when(n,t,e,r,u)}a?a.push(i):k(function(){i(h)})}function u(n){if(a){var e=a;a=J,k(function(){h=s(c,n),t&&v(h,t),f(e,h)})}}function i(n){u(new p(n))}function o(n){if(a){var t=a;k(function(){f(t,new l(n))})}}var c,h,a=[];c=this,this._status=t,this.inspect=e,this._when=r;try{n(u,i,o)}catch(y){i(y)}}function u(n){return n instanceof r?n:i(n)}function i(n){return e(function(t){t(n)})}function o(n){return t(n,function(n){return new p(n)})}function c(){function n(n,e,o){t.resolve=t.resolver.resolve=function(t){return u?i(t):(u=!0,n(t),r)},t.reject=t.resolver.reject=function(n){return u?i(new p(n)):(u=!0,e(n),r)},t.notify=t.resolver.notify=function(n){return o(n),n}}var t,r,u;return t={promise:J,resolve:J,reject:J,notify:J,resolver:{resolve:J,reject:J,notify:J}},t.promise=r=e(n),t}function f(n,t){for(var e=0;e<n.length;e++)n[e](t)}function s(n,t){if(t===n)return new p(new TypeError);if(t instanceof r)return t;try{var e=t===Object(t)&&t.then;return"function"==typeof e?h(e,t):new a(t)}catch(u){return new p(u)}}function h(n,t){return e(function(e,r){q(n,t,e,r)})}function a(n){this.value=n}function p(n){this.value=n}function l(n){this.value=n}function v(n,t){function e(){t.fulfilled()}function r(n){t.rejected(n)}n.then(e,r)}function y(n){return n&&"function"==typeof n.then}function d(n,r,u,i,o){return t(n,function(n){function c(e,u,i){function o(n){l(n)}function c(n){p(n)}var f,s,h,a,p,l,v,y;if(v=n.length>>>0,f=Math.max(0,Math.min(r,v)),h=[],s=v-f+1,a=[],f)for(l=function(n){a.push(n),--s||(p=l=E,u(a))},p=function(n){h.push(n),--f||(p=l=E,e(h))},y=0;v>y;++y)y in n&&t(n[y],c,o,i);else e(h)}return e(c).then(u,i,o)})}function w(n,t,e,r){function u(n){return t?t(n[0]):n[0]}return d(n,1,u,e,r)}function m(n,t,e,r){return x(n,E).then(t,e,r)}function b(){return x(arguments,E)}function j(n){return x(n,_,M)}function g(n,t){return x(n,t)}function x(n,e,u){return t(n,function(n){function i(r,i,o){function c(n,c){t(n,e,u).then(function(n){f[c]=n,--h||r(f)},i,o)}var f,s,h,a;if(h=s=n.length>>>0,f=[],!h)return void r(f);for(a=0;s>a;a++)a in n?c(n[a],a):--h}return new r(i)})}function O(n,e){var r=q(W,arguments,1);return t(n,function(n){var u;return u=n.length,r[0]=function(n,r,i){return t(n,function(n){return t(r,function(t){return e(n,t,i,u)})})},U.apply(n,r)})}function _(n){return{state:"fulfilled",value:n}}function M(n){return{state:"rejected",reason:n}}function T(){return{state:"pending"}}function k(n){1===C.push(n)&&A(P)}function P(){f(C),C=[]}function E(n){return n}function K(n){throw"function"==typeof D.reportUnhandled?D.reportUnhandled():k(function(){throw n}),n}t.promise=e,t.resolve=i,t.reject=o,t.defer=c,t.join=b,t.all=m,t.map=g,t.reduce=O,t.settle=j,t.any=w,t.some=d,t.isPromise=y,t.isPromiseLike=y,L=r.prototype,L.then=function(n,t,e){var u=this;return new r(function(r,i,o){u._when(r,o,n,t,e)},this._status&&this._status.observed())},L["catch"]=L.otherwise=function(n){return this.then(J,n)},L["finally"]=L.ensure=function(n){function t(){return i(n())}return"function"==typeof n?this.then(t,t)["yield"](this):this},L.done=function(n,t){this.then(n,t)["catch"](K)},L["yield"]=function(n){return this.then(function(){return n})},L.tap=function(n){return this.then(n)["yield"](this)},L.spread=function(n){return this.then(function(t){return m(t,function(t){return n.apply(J,t)})})},L.always=function(n,t){return this.then(n,n,t)},S=Object.create||function(n){function t(){}return t.prototype=n,new t},a.prototype=S(L),a.prototype.inspect=function(){return _(this.value)},a.prototype._when=function(n,t,e){try{n("function"==typeof e?e(this.value):this.value)}catch(r){n(new p(r))}},p.prototype=S(L),p.prototype.inspect=function(){return M(this.value)},p.prototype._when=function(n,t,e,r){try{n("function"==typeof r?r(this.value):this)}catch(u){n(new p(u))}},l.prototype=S(L),l.prototype._when=function(n,t,e,r,u){try{t("function"==typeof u?u(this.value):this.value)}catch(i){t(i)}};var L,S,U,W,q,A,C,F,z,B,D,G,H,I,J;if(H=n,C=[],D="undefined"!=typeof console?console:t,"object"==typeof process&&process.nextTick)A=process.nextTick;else if(I="function"==typeof MutationObserver&&MutationObserver||"function"==typeof WebKitMutationObserver&&WebKitMutationObserver)A=function(n,t,e){var r=n.createElement("div");return new t(e).observe(r,{attributes:!0}),function(){r.setAttribute("x","x")}}(document,I,P);else try{A=H("vertx").runOnLoop||H("vertx").runOnContext}catch(N){G=setTimeout,A=function(n){G(n,0)}}return F=Function.prototype,z=F.call,q=F.bind?z.bind(z):function(n,t){return n.apply(t,W.call(arguments,2))},B=[],W=B.slice,U=B.reduce||function(n){var t,e,r,u,i;if(i=0,t=Object(this),u=t.length>>>0,e=arguments,e.length<=1)for(;;){if(i in t){r=t[i++];break}if(++i>=u)throw new TypeError}else r=e[1];for(;u>i;++i)i in t&&(r=n(r,t[i],i,t));return r},t})}("function"==typeof define&&define.amd?define:function(n){module.exports=n(require)});