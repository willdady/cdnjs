(function(c,b,a,d){Foundation.libs["magellan-expedition"]={name:"magellan-expedition",version:"5.2.0",settings:{active_class:"active",threshold:0,destination_threshold:20,throttle_delay:30},init:function(f,g,e){Foundation.inherit(this,"throttle");this.bindings(g,e)},events:function(){var e=this,f=e.S,g=e.settings;e.set_expedition_position();f(e.scope).off(".magellan").on("click.fndtn.magellan","["+e.add_namespace("data-magellan-arrival")+'] a[href^="#"]',function(m){m.preventDefault();var l=c(this).closest("["+e.attr_name()+"]"),i=l.data("magellan-expedition-init");var k=this.hash.split("#").join(""),j=c("a[name="+k+"]");if(j.length===0){j=c("#"+k)}var h=j.offset().top;if(l.css("position")==="fixed"){h=h-l.outerHeight()}c("html, body").stop().animate({scrollTop:h},700,"swing",function(){b.location.hash="#"+k})}).on("scroll.fndtn.magellan",e.throttle(this.check_for_arrivals.bind(this),g.throttle_delay));c(b).on("resize.fndtn.magellan",e.throttle(this.set_expedition_position.bind(this),g.throttle_delay))},check_for_arrivals:function(){var e=this;e.update_arrivals();e.update_expedition_positions()},set_expedition_position:function(){var e=this;c("["+this.attr_name()+"=fixed]",e.scope).each(function(f,h){var j=c(this),i=j.attr("styles"),g;j.attr("style","");g=j.offset().top;j.data(e.data_attr("magellan-top-offset"),g);j.attr("style",i)})},update_expedition_positions:function(){var f=this,e=c(b).scrollTop();c("["+this.attr_name()+"=fixed]",f.scope).each(function(){var h=c(this),g=h.data("magellan-top-offset");if(e>=g){var i=h.prev("["+f.add_namespace("data-magellan-expedition-clone")+"]");if(i.length===0){i=h.clone();i.removeAttr(f.attr_name());i.attr(f.add_namespace("data-magellan-expedition-clone"),"");h.before(i)}h.css({position:"fixed",top:0})}else{h.prev("["+f.add_namespace("data-magellan-expedition-clone")+"]").remove();h.attr("style","")}})},update_arrivals:function(){var f=this,e=c(b).scrollTop();c("["+this.attr_name()+"]",f.scope).each(function(){var k=c(this),g=g=k.data(f.attr_name(true)+"-init"),i=f.offsets(k,e),j=k.find("["+f.add_namespace("data-magellan-arrival")+"]"),h=false;i.each(function(l,m){if(m.viewport_offset>=m.top_offset){var n=k.find("["+f.add_namespace("data-magellan-arrival")+"]");n.not(m.arrival).removeClass(g.active_class);m.arrival.addClass(g.active_class);h=true;return true}});if(!h){j.removeClass(g.active_class)}})},offsets:function(i,e){var f=this,g=i.data(f.attr_name(true)+"-init"),h=(e+g.destination_threshold);return i.find("["+f.add_namespace("data-magellan-arrival")+"]").map(function(j,n){var m=c(this).data(f.data_attr("magellan-arrival")),l=c("["+f.add_namespace("data-magellan-destination")+"="+m+"]");if(l.length>0){var k=l.offset().top;return{destination:l,arrival:c(this),top_offset:k,viewport_offset:h}}}).sort(function(k,j){if(k.top_offset<j.top_offset){return -1}if(k.top_offset>j.top_offset){return 1}return 0})},data_attr:function(e){if(this.namespace.length>0){return this.namespace+"-"+e}return e},off:function(){this.S(this.scope).off(".magellan");this.S(b).off(".magellan")},reflow:function(){var e=this;c("["+e.add_namespace("data-magellan-expedition-clone")+"]",e.scope).remove()}}}(jQuery,this,this.document));